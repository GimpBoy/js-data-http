!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-data"),require("undefined")):"function"==typeof define&&define.amd?define(["js-data","undefined"],t):"object"==typeof exports?exports.HttpAdapter=t(require("js-data"),require("undefined")):e.HttpAdapter=t(e.JSData,e.undefined)}(this,function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){return null!=e&&""!==e}function a(e,t){return t||(t=""),e.filter(o).join(t)}function i(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];var n=a(t,"/");return n.replace(/([^:\/]|^)\/{2,}/g,"$1/")}function u(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function f(e,t){if(!t)return e;var r=[];return v(t,function(e,t){null!==e&&"undefined"!=typeof e&&(T(e)||(e=[e]),e.forEach(function(e){"[object Date]"===window.toString.call(e)?e=e.toISOString():A(e)&&(e=S(e)),r.push(u(t)+"="+u(e))}))}),r.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+r.join("&")),e}function s(e){var t=this;e||(e={}),b(t,e),b(t,F)}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},d=r(1),l=r(2),c=d.utils._,h=d.utils.addHiddenPropsToTarget,m=d.utils.copy,y=d.utils.deepMixIn,g=d.utils.extend,b=d.utils.fillIn,v=d.utils.forOwn,T=d.utils.isArray,x=d.utils.isFunction,P=d.utils.isNumber,A=d.utils.isObject,E=d.utils.isSorN,U=d.utils.isString,z=d.utils.isUndefined,q=d.utils.resolve,D=d.utils.reject,S=d.utils.toJson,w=!1;try{w=window&&window.fetch}catch(e){}var j=function(){for(var e=this,t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];var o=r[r.length-1];e.dbg.apply(e,[o.op].concat(r))},C=function(){for(var e=this,t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];var o=r[r.length-2];e.dbg.apply(e,[o.op].concat(r))},F={basePath:"",debug:!1,forceTrailingSlash:!1,http:l,httpConfig:{},suffix:"",useFetch:!1};h(s.prototype,{afterCreate:C,afterCreateMany:C,afterDEL:C,afterDestroy:C,afterDestroyAll:C,afterFind:C,afterFindAll:C,afterGET:C,afterHTTP:C,afterPOST:C,afterPUT:C,afterUpdate:C,afterUpdateAll:C,afterUpdateMany:C,beforeCreate:j,beforeCreateMany:j,beforeDEL:j,beforeDestroy:j,beforeDestroyAll:j,beforeFind:j,beforeFindAll:j,beforeGET:j,beforeHTTP:j,beforePOST:j,beforePUT:j,beforeUpdate:j,beforeUpdateAll:j,beforeUpdateMany:j,create:function(e,t,r){var n=this,o=void 0;return r=r?m(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeCreate",q(n[o](e,t,r)).then(function(){return o=r.op="create",n.dbg(o,e,t,r),n.POST(n.getPath("create",e,t,r),n.serialize(e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterCreate",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},createMany:function(e,t,r){var n=this,o=void 0;return r=r?m(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeCreateMany",q(n[o](e,t,r)).then(function(){return o=r.op="createMany",n.dbg(o,e,t,r),n.POST(n.getPath("createMany",e,null,r),n.serialize(e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterCreateMany",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},dbg:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))},DEL:function(e,t,r){var n=this,o=void 0;return t||(t={}),r||(r={}),t.url=e||t.url,t.method=t.method||"delete",o=r.op="beforeDEL",q(n[o](e,t,r)).then(function(a){return t=z(a)?t:a,o=r.op="DEL",n.dbg(o,e,t,r),n.HTTP(t,r)}).then(function(a){return o=r.op="afterDEL",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},deserialize:function(e,t,r){return r||(r={}),x(r.deserialize)?r.deserialize(e,t,r):x(e.deserialize)?e.deserialize(e,t,r):r.raw?t:t&&"data"in t?t.data:t},destroy:function(e,t,r){var n=this,o=void 0;return r=r?m(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeDestroy",q(n[o](e,t,r)).then(function(){return o=r.op="destroy",n.dbg(o,e,t,r),n.DEL(n.getPath("destroy",e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterDestroy",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},destroyAll:function(e,t,r){var n=this,o=void 0;return t||(t={}),r=r?m(r):{},r.params||(r.params={}),y(r.params,t),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeDestroyAll",q(n.beforeDestroyAll(e,t,r)).then(function(){return o=r.op="destroyAll",n.dbg(o,e,t,r),n.DEL(n.getPath("destroyAll",e,null,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterDestroyAll",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},error:function(){if(console){var e;(e=console)["function"==typeof console.error?"error":"log"].apply(e,arguments)}},fetch:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var r={method:e.method,headers:new Headers(e.headers)};return e.data&&(r.body=S(e.data)),fetch(new Request(f(e.url,e.params),r)).then(function(t){return t.config={method:e.method,url:e.url},t.json().then(function(e){return t.data=e,t})})}),find:function(e,t,r){var n=this,o=void 0;return r=r?m(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeFind",q(n[o](e,t,r)).then(function(){return o=r.op="find",n.dbg(o,e,t,r),n.GET(n.getPath("find",e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterFind",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},findAll:function(e,t,r){var n=this,o=void 0;return t||(t={}),r=r?m(r):{},r.params||(r.params={}),r.suffix=z(r.suffix)?e.suffix:r.suffix,y(r.params,t),r.params=n.queryTransform(e,r.params,r),o=r.op="beforeFindAll",q(n[o](e,t,r)).then(function(){return o=r.op="findAll",n.dbg(o,e,t,r),n.GET(n.getPath("findAll",e,r.params,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterFindAll",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},GET:function(e,t,r){var n=this,o=void 0;return t||(t={}),r||(r={}),t.url=e||t.url,t.method=t.method||"get",o=r.op="beforeGET",q(n[o](e,t,r)).then(function(a){return t=z(a)?t:a,o=r.op="GET",n.dbg(o,e,t,r),n.HTTP(t,r)}).then(function(a){return o=r.op="afterGET",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},getEndpoint:function(e,t,r){var o=this;r||(r={}),r.params||(r.params={});var a=r.hasOwnProperty("endpoint")?r.endpoint:e.endpoint,u=e.parents||(e.parent?n({},e.parent,{key:e.parentKey,field:e.parentField}):{});return v(u,function(n,u){var f=void 0,s=n.key,d=n.field,l=e.getResource(u),h=r.params[s];if(h===!1||!s||!l)return h===!1&&delete r.params[s],!1;if(delete r.params[s],U(t)||P(t)?f=e.get(t):A(t)&&(f=t),f&&(h=h||f[s]||(f[d]?f[d][l.idAttribute]:null)),h){var m=function(){delete r.endpoint;var e={};return v(r,function(t,r){e[r]=t}),c(e,l),a=i(o.getEndpoint(l,h,e,h,a)),{v:!1}}();if("object"===("undefined"==typeof m?"undefined":p(m)))return m.v}}),a},getPath:function(e,t,r,n){var o=this;n||(n={});var a=[void 0===n.basePath?void 0===t.basePath?o.basePath:t.basePath:n.basePath,o.getEndpoint(t,U(r)||P(r)||"create"===e?r:null,n)];return"find"!==e&&"update"!==e&&"destroy"!==e||a.push(r),i.apply(d.utils,a)},HTTP:function(e,t){function r(t){var r=o.toUTCString()+" - "+e.method.toUpperCase()+" "+e.url+" - "+t.status+" "+((new Date).getTime()-o.getTime())+"ms";return t.status>=200&&t.status<300?(n.log&&n.dbg("debug",r,t),t):(n.error&&n.error("'FAILED: "+r,t),D(t))}var n=this,o=new Date;t||(t={}),e=m(e),e=y(e,n.httpConfig),n.forceTrailingSlash&&"/"!==e.url[e.url.length-1]&&(e.url+="/"),e.method=e.method.toUpperCase();var a=e.suffix||t.suffix||n.suffix;if(a&&e.url.substr(e.url.length-a.length)!==a&&(e.url+=a),!n.http)throw new Error("You have not configured this adapter with an http library!");return q(n.beforeHTTP(e,t)).then(function(o){return e=o||e,w&&(n.useFetch||t.useFetch||!n.http)?n.fetch(e,t).then(r,r):n.http(e).then(r,r).catch(function(r){return n.responseError(r,e,t)})}).then(function(r){return q(n.afterHTTP(e,t,r)).then(function(e){return e||r})})},log:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];if(e&&!r.length&&(r.push(e),e="debug"),"debug"!==e||this.debug){var o=e.toUpperCase()+": (HttpAdapter)";if(console[e]){var a;(a=console)[e].apply(a,[o].concat(r))}else{var i;(i=console).log.apply(i,[o].concat(r))}}},POST:function(e,t,r,n){var o=this,a=void 0;return r||(r={}),n||(n={}),r.url=e||r.url,r.data=t||r.data,r.method=r.method||"post",a=n.op="beforePOST",q(o[a](e,t,r,n)).then(function(i){return r=z(i)?r:i,a=n.op="POST",o.dbg(a,e,t,r,n),o.HTTP(r,n)}).then(function(i){return a=n.op="afterPOST",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},PUT:function(e,t,r,n){var o=this,a=void 0;return r||(r={}),n||(n={}),r.url=e||r.url,r.data=t||r.data,r.method=r.method||"put",a=n.op="beforePUT",q(o[a](e,t,r,n)).then(function(i){return r=z(i)?r:i,a=n.op="PUT",o.dbg(a,e,t,r,n),o.HTTP(r,n)}).then(function(i){return a=n.op="afterPUT",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},queryTransform:function(e,t,r){return r||(r={}),x(r.queryTransform)?r.queryTransform(e,t,r):x(e.queryTransform)?e.queryTransform(e,t,r):t},responseError:function(e,t,r){return D(e)},serialize:function(e,t,r){return r||(r={}),x(r.serialize)?r.serialize(e,t,r):x(e.serialize)?e.serialize(e,t,r):t},update:function(e,t,r,n){var o=this,a=void 0;return n=n?m(n):{},n.params||(n.params={}),n.params=o.queryTransform(e,n.params,n),n.suffix=z(n.suffix)?e.suffix:n.suffix,a=n.op="beforeUpdate",q(o[a](e,t,r,n)).then(function(){return a=n.op="update",o.dbg(a,e,t,r,n),o.PUT(o.getPath("update",e,t,n),o.serialize(e,r,n),n)}).then(function(t){return o.deserialize(e,t,n)}).then(function(i){return a=n.op="afterUpdate",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},updateAll:function(e,t,r,n){var o=this,a=void 0;return r||(r={}),n=n?m(n):{},n.params||(n.params={}),y(n.params,r),n.params=o.queryTransform(e,n.params,n),n.suffix=z(n.suffix)?e.suffix:n.suffix,a=n.op="beforeUpdateAll",q(o[a](e,t,r,n)).then(function(){return a=n.op="updateAll",o.dbg(a,e,t,r,n),o.PUT(o.getPath("updateAll",e,null,n),o.serialize(e,t,n),n)}).then(function(t){return o.deserialize(e,t,n)}).then(function(i){return a=n.op="afterUpdateAll",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},updateMany:function(e,t,r){var n=this,o=void 0;return r=r?m(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeUpdateMany",q(n[o](e,t,r)).then(function(){return o=r.op="updateMany",n.dbg(o,e,t,r),n.PUT(n.getPath("updateMany",e,null,r),n.serialize(e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterUpdateMany",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})}}),s.addAction=function(e,t){if(!e||!U(e))throw new TypeError("action(name[, opts]): Expected: string, Found: "+("undefined"==typeof e?"undefined":p(e)));return function(r){if(r[e])throw new Error("action(name[, opts]): "+e+" already exists on target!");return t.request=t.request||function(e){return e},t.response=t.response||function(e){return e},t.responseError=t.responseError||function(e){return D(e)},r[e]=function(r,n){var o=this;A(r)&&(n=r),n=n||{};var a=o.getAdapter(t.adapter||o.defaultAdapter||"http"),u={};if(b(u,t),!n.hasOwnProperty("endpoint")&&u.endpoint&&(n.endpoint=u.endpoint),"function"==typeof n.getEndpoint)u.url=n.getEndpoint(o,n);else{var f=[n.basePath||o.basePath||a.basePath,a.getEndpoint(o,E(r)?r:null,n)];E(r)&&f.push(r),f.push(t.pathname||e),u.url=i.apply(null,f)}return u.method=u.method||"GET",u.mapper=o.name,y(u)(n),q(u).then(n.request||t.request).then(function(e){return a.HTTP(e)}).then(function(e){return e&&e.config&&(e.config.mapper=o.name),e}).then(n.response||t.response,n.responseError||t.responseError)},r}},s.addActions=function(e){return e||(e={}),function(e){return v(e,function(t,r){s.addAction(r,t)(e)}),e}},s.extend=g,s.version={full:"<%= pkg.version %>",major:parseInt("<%= major %>",10),minor:parseInt("<%= minor %>",10),patch:parseInt("<%= patch %>",10),alpha:"<%= alpha %>",beta:"<%= beta %>"},e.exports=s},function(t,r){t.exports=e},function(e,t){e.exports=void 0}])});
//# sourceMappingURL=fetch/dist/js-data-fetch.min.map