!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("js-data"),require("undefined")):"function"==typeof define&&define.amd?define(["js-data","undefined"],t):"object"==typeof exports?exports.HttpAdapter=t(require("js-data"),require("undefined")):e.HttpAdapter=t(e.JSData,e.undefined)}(this,function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return null!=e&&""!==e}function o(e,t){return t||(t=""),e.filter(n).join(t)}function a(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];var n=o(t,"/");return n.replace(/([^:\/]|^)\/{2,}/g,"$1/")}function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function u(e,t){if(!t)return e;var r=[];return b(t,function(e,t){null!==e&&"undefined"!=typeof e&&(v(e)||(e=[e]),e.forEach(function(e){"[object Date]"===window.toString.call(e)?e=e.toISOString():A(e)&&(e=S(e)),r.push(i(t)+"="+i(e))}))}),r.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+r.join("&")),e}function f(e){var t=this;e||(e={}),y(t,e),y(t,j)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},p=r(1),d=r(2),l=p.utils._,c=p.utils.addHiddenPropsToTarget,h=p.utils.copy,m=p.utils.deepMixIn,g=p.utils.extend,y=p.utils.fillIn,b=p.utils.forOwn,T=p.utils.get,v=p.utils.isArray,x=p.utils.isFunction,P=p.utils.isNumber,A=p.utils.isObject,E=p.utils.isSorN,U=p.utils.isString,z=p.utils.isUndefined,q=p.utils.resolve,D=p.utils.reject,S=p.utils.toJson,w=!1;try{w=window&&window.fetch}catch(e){}var F=function(){for(var e=this,t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];var o=r[r.length-1];e.dbg.apply(e,[o.op].concat(r))},C=function(){for(var e=this,t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];var o=r[r.length-2];e.dbg.apply(e,[o.op].concat(r))},j={basePath:"",debug:!1,forceTrailingSlash:!1,http:d,httpConfig:{},suffix:"",useFetch:!1};c(f.prototype,{afterCreate:C,afterCreateMany:C,afterDEL:C,afterDestroy:C,afterDestroyAll:C,afterFind:C,afterFindAll:C,afterGET:C,afterHTTP:C,afterPOST:C,afterPUT:C,afterUpdate:C,afterUpdateAll:C,afterUpdateMany:C,beforeCreate:F,beforeCreateMany:F,beforeDEL:F,beforeDestroy:F,beforeDestroyAll:F,beforeFind:F,beforeFindAll:F,beforeGET:F,beforeHTTP:F,beforePOST:F,beforePUT:F,beforeUpdate:F,beforeUpdateAll:F,beforeUpdateMany:F,create:function(e,t,r){var n=this,o=void 0;return r=r?h(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeCreate",q(n[o](e,t,r)).then(function(){return o=r.op="create",n.dbg(o,e,t,r),n.POST(n.getPath("create",e,t,r),n.serialize(e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterCreate",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},createMany:function(e,t,r){var n=this,o=void 0;return r=r?h(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeCreateMany",q(n[o](e,t,r)).then(function(){return o=r.op="createMany",n.dbg(o,e,t,r),n.POST(n.getPath("createMany",e,null,r),n.serialize(e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterCreateMany",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},dbg:function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];this.log.apply(this,["debug"].concat(t))},DEL:function(e,t,r){var n=this,o=void 0;return t||(t={}),r||(r={}),t.url=e||t.url,t.method=t.method||"delete",o=r.op="beforeDEL",q(n[o](e,t,r)).then(function(a){return t=z(a)?t:a,o=r.op="DEL",n.dbg(o,e,t,r),n.HTTP(t,r)}).then(function(a){return o=r.op="afterDEL",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},deserialize:function(e,t,r){return r||(r={}),x(r.deserialize)?r.deserialize(e,t,r):x(e.deserialize)?e.deserialize(e,t,r):r.raw?t:t&&"data"in t?t.data:t},destroy:function(e,t,r){var n=this,o=void 0;return r=r?h(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeDestroy",q(n[o](e,t,r)).then(function(){return o=r.op="destroy",n.dbg(o,e,t,r),n.DEL(n.getPath("destroy",e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterDestroy",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},destroyAll:function(e,t,r){var n=this,o=void 0;return t||(t={}),r=r?h(r):{},r.params||(r.params={}),m(r.params,t),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeDestroyAll",q(n.beforeDestroyAll(e,t,r)).then(function(){return o=r.op="destroyAll",n.dbg(o,e,t,r),n.DEL(n.getPath("destroyAll",e,null,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterDestroyAll",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},error:function(){if(console){var e;(e=console)["function"==typeof console.error?"error":"log"].apply(e,arguments)}},fetch:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var r={method:e.method,headers:new Headers(e.headers)};return e.data&&(r.body=S(e.data)),fetch(new Request(u(e.url,e.params),r)).then(function(t){return t.config={method:e.method,url:e.url},t.json().then(function(e){return t.data=e,t})})}),find:function(e,t,r){var n=this,o=void 0;return r=r?h(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeFind",q(n[o](e,t,r)).then(function(){return o=r.op="find",n.dbg(o,e,t,r),n.GET(n.getPath("find",e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterFind",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},findAll:function(e,t,r){var n=this,o=void 0;return t||(t={}),r=r?h(r):{},r.params||(r.params={}),r.suffix=z(r.suffix)?e.suffix:r.suffix,m(r.params,t),r.params=n.queryTransform(e,r.params,r),o=r.op="beforeFindAll",q(n[o](e,t,r)).then(function(){return o=r.op="findAll",n.dbg(o,e,t,r),n.GET(n.getPath("findAll",e,r.params,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterFindAll",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},GET:function(e,t,r){var n=this,o=void 0;return t||(t={}),r||(r={}),t.url=e||t.url,t.method=t.method||"get",o=r.op="beforeGET",q(n[o](e,t,r)).then(function(a){return t=z(a)?t:a,o=r.op="GET",n.dbg(o,e,t,r),n.HTTP(t,r)}).then(function(a){return o=r.op="afterGET",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})},getEndpoint:function(e,t,r){var n=this;r||(r={}),r.params||(r.params={});var o=e.relationList||[],i=z(r.endpoint)?z(e.endpoint)?e.name:e.endpoint:r.endpoint;return o.forEach(function(e){if("belongsTo"===e.type&&e.parent){var o=void 0,u=e.foreignKey,f=e.getRelation(),p=r.params[u];if(p===!1||!u||!f)return p===!1&&delete r.params[u],!1;if(delete r.params[u],A(t)&&(o=t),o&&(p=p||e.getForeignKey(o)||(e.getLocalField(o)?T(e.getLocalField(o),f.idAttribute):null)),p){var d=function(){delete r.endpoint;var e={};return b(r,function(t,r){e[r]=t}),l(e,f),i=a(n.getEndpoint(f,p,e),p,i),{v:!1}}();if("object"===("undefined"==typeof d?"undefined":s(d)))return d.v}}}),i},getPath:function(e,t,r,n){var o=this;n||(n={});var i=[z(n.basePath)?z(t.basePath)?o.basePath:t.basePath:n.basePath,o.getEndpoint(t,U(r)||P(r)||"create"===e?r:null,n)];return"find"!==e&&"update"!==e&&"destroy"!==e||i.push(r),a.apply(p.utils,i)},HTTP:function(e,t){function r(t){var r=o.toUTCString()+" - "+e.method.toUpperCase()+" "+e.url+" - "+t.status+" "+((new Date).getTime()-o.getTime())+"ms";return t.status>=200&&t.status<300?(n.log&&n.dbg("debug",r,t),t):(n.error&&n.error("'FAILED: "+r,t),D(t))}var n=this,o=new Date;t||(t={}),e=h(e),e=m(e,n.httpConfig),n.forceTrailingSlash&&"/"!==e.url[e.url.length-1]&&(e.url+="/"),e.method=e.method.toUpperCase();var a=e.suffix||t.suffix||n.suffix;if(a&&e.url.substr(e.url.length-a.length)!==a&&(e.url+=a),!n.http)throw new Error("You have not configured this adapter with an http library!");return q(n.beforeHTTP(e,t)).then(function(o){return e=o||e,w&&(n.useFetch||t.useFetch||!n.http)?n.fetch(e,t).then(r,r):n.http(e).then(r,r).catch(function(r){return n.responseError(r,e,t)})}).then(function(r){return q(n.afterHTTP(e,t,r)).then(function(e){return e||r})})},log:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];if(e&&!r.length&&(r.push(e),e="debug"),"debug"!==e||this.debug){var o=e.toUpperCase()+": (HttpAdapter)";if(console[e]){var a;(a=console)[e].apply(a,[o].concat(r))}else{var i;(i=console).log.apply(i,[o].concat(r))}}},POST:function(e,t,r,n){var o=this,a=void 0;return r||(r={}),n||(n={}),r.url=e||r.url,r.data=t||r.data,r.method=r.method||"post",a=n.op="beforePOST",q(o[a](e,t,r,n)).then(function(i){return r=z(i)?r:i,a=n.op="POST",o.dbg(a,e,t,r,n),o.HTTP(r,n)}).then(function(i){return a=n.op="afterPOST",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},PUT:function(e,t,r,n){var o=this,a=void 0;return r||(r={}),n||(n={}),r.url=e||r.url,r.data=t||r.data,r.method=r.method||"put",a=n.op="beforePUT",q(o[a](e,t,r,n)).then(function(i){return r=z(i)?r:i,a=n.op="PUT",o.dbg(a,e,t,r,n),o.HTTP(r,n)}).then(function(i){return a=n.op="afterPUT",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},queryTransform:function(e,t,r){return r||(r={}),x(r.queryTransform)?r.queryTransform(e,t,r):x(e.queryTransform)?e.queryTransform(e,t,r):t},responseError:function(e,t,r){return D(e)},serialize:function(e,t,r){return r||(r={}),x(r.serialize)?r.serialize(e,t,r):x(e.serialize)?e.serialize(e,t,r):t},update:function(e,t,r,n){var o=this,a=void 0;return n=n?h(n):{},n.params||(n.params={}),n.params=o.queryTransform(e,n.params,n),n.suffix=z(n.suffix)?e.suffix:n.suffix,a=n.op="beforeUpdate",q(o[a](e,t,r,n)).then(function(){return a=n.op="update",o.dbg(a,e,t,r,n),o.PUT(o.getPath("update",e,t,n),o.serialize(e,r,n),n)}).then(function(t){return o.deserialize(e,t,n)}).then(function(i){return a=n.op="afterUpdate",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},updateAll:function(e,t,r,n){var o=this,a=void 0;return r||(r={}),n=n?h(n):{},n.params||(n.params={}),m(n.params,r),n.params=o.queryTransform(e,n.params,n),n.suffix=z(n.suffix)?e.suffix:n.suffix,a=n.op="beforeUpdateAll",q(o[a](e,t,r,n)).then(function(){return a=n.op="updateAll",o.dbg(a,e,t,r,n),o.PUT(o.getPath("updateAll",e,null,n),o.serialize(e,t,n),n)}).then(function(t){return o.deserialize(e,t,n)}).then(function(i){return a=n.op="afterUpdateAll",q(o[a](e,t,r,n,i)).then(function(e){return z(e)?i:e})})},updateMany:function(e,t,r){var n=this,o=void 0;return r=r?h(r):{},r.params||(r.params={}),r.params=n.queryTransform(e,r.params,r),r.suffix=z(r.suffix)?e.suffix:r.suffix,o=r.op="beforeUpdateMany",q(n[o](e,t,r)).then(function(){return o=r.op="updateMany",n.dbg(o,e,t,r),n.PUT(n.getPath("updateMany",e,null,r),n.serialize(e,t,r),r)}).then(function(t){return n.deserialize(e,t,r)}).then(function(a){return o=r.op="afterUpdateMany",q(n[o](e,t,r,a)).then(function(e){return z(e)?a:e})})}}),f.addAction=function(e,t){if(!e||!U(e))throw new TypeError("action(name[, opts]): Expected: string, Found: "+("undefined"==typeof e?"undefined":s(e)));return function(r){if(r[e])throw new Error("action(name[, opts]): "+e+" already exists on target!");return t.request=t.request||function(e){return e},t.response=t.response||function(e){return e},t.responseError=t.responseError||function(e){return D(e)},r[e]=function(r,n){var o=this;A(r)&&(n=r),n=n||{};var i=o.getAdapter(t.adapter||o.defaultAdapter||"http"),u={};if(y(u,t),!n.hasOwnProperty("endpoint")&&u.endpoint&&(n.endpoint=u.endpoint),"function"==typeof n.getEndpoint)u.url=n.getEndpoint(o,n);else{var f=[n.basePath||o.basePath||i.basePath,i.getEndpoint(o,E(r)?r:null,n)];E(r)&&f.push(r),f.push(t.pathname||e),u.url=a.apply(null,f)}return u.method=u.method||"GET",u.mapper=o.name,m(u)(n),q(u).then(n.request||t.request).then(function(e){return i.HTTP(e)}).then(function(e){return e&&e.config&&(e.config.mapper=o.name),e}).then(n.response||t.response,n.responseError||t.responseError)},r}},f.addActions=function(e){return e||(e={}),function(e){return b(e,function(t,r){f.addAction(r,t)(e)}),e}},f.extend=g,f.version={full:"<%= pkg.version %>",major:parseInt("<%= major %>",10),minor:parseInt("<%= minor %>",10),patch:parseInt("<%= patch %>",10),alpha:"<%= alpha %>",beta:"<%= beta %>"},e.exports=f},function(t,r){t.exports=e},function(e,t){e.exports=void 0}])});
//# sourceMappingURL=fetch/dist/js-data-fetch.min.map